define("common:widget/blue-book-ad/blue-book-ad.js",function(e,o,i){var t=e("common:widget/lib/tangram/base/base.js"),a=e("common:widget/ui/dialog/dialog.js"),n=(e("common:widget/ui/login/login.js"),e("common:widget/lib/fis/event/event.js").eventCenter),s={ele:t.g("blue-book-ads"),initDom:function(e,o){var i=[],a="";e?(a=!o.box.is_open&&o.box.open_grade<=o.grade.grade?"你的礼包可开启啦！":o.grade.is_know?o.taskbook.max_grade>o.grade.grade?"你有新的任务哦！":"小蓝本已升至顶级！":"你的小蓝本升级啦！",o.grade.is_know||(t.dom.addClass(this.ele,"blue-book-upgrade"),t.dom.setAttr(this.ele,"data-grade",o.grade.grade))):a="登录后开启小蓝本！",i.push('<div class="blue-book-link blue-bg">'),i.push('<div class="blue-book-tip blue-bg">'+a+"</div>"),i.push("</div>"),o&&(i.push('<div class="blue-book-title">'),i.push("<strong>"+o.taskbook.title+"</strong>"),i.push('<p>当前等级：<span class="em">'+o.grade.grade+"级</span></p>"),i.push("</div>")),i.push('<em id="blue-close" class="blue-close blue-bg"></em>'),this.ele.innerHTML=i.join(""),this.fixable(),this.bindEvent()},_fixable:function(){var e=t.page.getViewWidth(),o=0;e>1400&&(o+=(e-1400)/2),t.dom.fixable(this.ele,{vertival:"bottom",horizontal:"right",offset:{x:o,y:250},autofix:!0}),this.ele.style.display="block"},fixable:function(){var e=this;e._fixable(),(!t.browser.ie||t.browser.ie>7)&&t.on(window,"resize",function(){e._fixable()})},bindEvent:function(){var e=this;t.on("blue-book-ads","click",function(o){var i=t.event.getTarget(o);"blue-close"!==i.id?n.fire("login.check",{isLogin:function(){var o,i="/taskbook?page=taskbook&name=blue&_="+~new Date;if(F.context("isLogin")||(F.context("isLogin",1),e.init(),o=function(){window.location.reload(!0)}),a.iframe("小蓝本任务",{skin:"blue-book-task",url:i,width:912,transparent:1,height:600,onclose:o}),t.dom.hasClass(e.ele,"blue-book-upgrade")){t.dom.removeClass(e.ele,"blue-book-upgrade");var n=t.dom.getAttr(e.ele,"data-grade"),i="/taskbookasyn?act=confirm_promotion",s="name=blue&grade="+n;t.ajax.post(i,s,function(){})}}}):e.ele.style.display="none"})},init:function(){var e=F.context("isLogin"),o=this;e?t.ajax.post("/taskbookasyn?act=get_user_info","name=blue",function(e,i){i=t.json.parse(i),0==i.errno&&o.initDom(1,i)}):this.initDom(!1,!1)}};i.exports=s});